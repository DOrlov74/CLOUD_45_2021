(this["webpackJsonpclient-app"]=this["webpackJsonpclient-app"]||[]).push([[0],{163:function(e,t,n){},191:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),o=n(60),r=n.n(o),i=(n(162),n(163),n(7)),s=n(204),l=n(15),u=n(209),d=n(66),j=n(213),b=n(91),h=n(145),O=n(16),f=n(45),m=n.n(f);m.a.defaults.baseURL="/api",m.a.interceptors.request.use((function(e){var t=window.localStorage.getItem("jwt");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}));var p=function(e){return e.status<300?e.data:null},x=function(e){return e.status<300?e.data:[]},v=function(e){return m.a.get(e).then(p)},g=function(e){return m.a.get(e).then(x)},S=function(e,t){return m.a.post(e,t).then(p)},I=function(e,t){return m.a.put(e,t).then(p)},P=function(e){return m.a.delete(e).then(p)},C={Stores:{list:function(){return g("/store")},details:function(e){return v("/store/".concat(e))},create:function(e){return S("/store",e)},update:function(e){return I("/store/".concat(e.Id),e)},delete:function(e){return P("/store/".concat(e))}},Sales:{list:function(){return g("/sale")},details:function(e){return v("/sale/".concat(e))},create:function(e){return S("/sale",e)},update:function(e){return I("/sale/".concat(e.SaleId),e)},delete:function(e){return P("/sale/".concat(e))}},SalesDetails:{list:function(){return g("/salesdetail")},details:function(e){return v("/salesdetail/".concat(e))},create:function(e){return S("/salesdetail",e)},update:function(e){return I("/salesdetail/".concat(e.SalesDetailId),e)},delete:function(e){return P("/salesdetail/".concat(e))}},Products:{list:function(){return g("/product")},details:function(e){return v("/product/".concat(e))},create:function(e){return S("/product",e)},update:function(e){return I("/product/".concat(e.ProductId),e)},delete:function(e){return P("/product/".concat(e))}},Families:{list:function(){return g("/family")},details:function(e){return v("/family/".concat(e))},create:function(e){return S("/family",e)},update:function(e){return I("/family/".concat(e.FamilyId),e)},delete:function(e){return P("/family/".concat(e))}},Users:{current:function(){return v("/user")},details:function(e){return v("/user/".concat(e))},create:function(e){return S("/user",e)},update:function(e){return I("/user/".concat(e.Id),e)},delete:function(e){return P("/user/".concat(e))}},Roles:{list:function(){return g("/user/role")},details:function(e){return v("/user/role/".concat(e))},create:function(e){return S("/user/role",e)},addrole:function(e,t){return S("/user/role/".concat(e),t)},delete:function(e){return P("/user/role/".concat(e))}},Account:{current:function(){return v("/account")},login:function(e){return S("/login",e)},register:function(e){return S("/register",e)},logout:function(){return v("/logout")}},Images:{upload:function(e){var t=new FormData;return t.append("File",e),m.a.post("/photo/add",t,{headers:{"Content-type":"multipart/form-data"}})},list:function(){return g("/photo")},details:function(e){return v("/photo/".concat(e))},create:function(e){return S("/photo",e)},update:function(e){return I("/photo/".concat(e.Id),e)},delete:function(e){return P("/photo/".concat(e))}}},y=n(1),U={user:null,setUser:null,userRoles:[],setUserRoles:null,roles:[],setRoles:null,userToken:null,setToken:null,getCurrentUser:null,photos:[],userPhotos:[]},N=Object(c.createContext)(U);function D(e){var t=e.children,n=Object(c.useState)(null),a=Object(i.a)(n,2),o=a[0],r=a[1],s=Object(c.useState)([]),l=Object(i.a)(s,2),u=l[0],d=l[1],j=Object(c.useState)([]),b=Object(i.a)(j,2),h=b[0],O=b[1],f=Object(c.useState)([]),m=Object(i.a)(f,2),p=m[0],x=m[1],v=Object(c.useState)([]),g=Object(i.a)(v,2),S=g[0],I=g[1],P=Object(c.useState)(window.localStorage.getItem("jwt")),U=Object(i.a)(P,2),D=U[0],F=U[1];return Object(c.useEffect)((function(){C.Roles.list().then((function(e){null!==e&&d(e)})).catch((function(e){console.log(e)}))}),[]),Object(c.useEffect)((function(){C.Images.list().then((function(e){null!==e&&x(e)})).catch((function(e){console.log(e)}))}),[]),Object(c.useEffect)((function(){var e=[];null===o||void 0===o||o.Roles.map((function(t){var n=u.find((function(e){return e.Id===t}));void 0===n||e.some((function(e){return e.Id===t}))||e.push(n)})),O(e)}),[o,u]),Object(c.useEffect)((function(){var e=[];null===o||void 0===o||o.Photos.map((function(t){var n=p.find((function(e){return e.Id===t.Id}));void 0===n||S.some((function(e){return e.Id===t.Id}))||e.push(n)})),I(e)}),[o,p]),Object(y.jsx)(N.Provider,{value:{user:o,setUser:r,userRoles:h,setUserRoles:O,roles:u,setRoles:d,userToken:D,setToken:function(e){e&&(window.localStorage.setItem("jwt",e),F(e))},getCurrentUser:function(){null!==D&&(console.log("Trying to get user ..."),C.Users.current().then((function(e){console.log(e),r(e)})).catch((function(e){console.log(e)})))},photos:p,userPhotos:S},children:t})}var F={userSales:[],activeSale:null,setActiveSale:null,userSalesDetails:[],setUserSalesDetails:null,activeSalesDetails:[],setActiveSalesDetails:null,products:[],setProducts:null,families:[],cartProducts:[],fillUserSales:null,fillCartProducts:null,fillUserSalesDetails:null,fillActiveSalesDetails:null,clearCart:null},w=Object(c.createContext)(F);function k(e){var t=e.children,n=a.a.useContext(N),o=Object(c.useState)(null),r=Object(i.a)(o,2),s=r[0],l=r[1],u=Object(c.useState)(null),d=Object(i.a)(u,2),j=d[0],b=d[1],h=Object(c.useState)([]),f=Object(i.a)(h,2),m=f[0],p=f[1],x=Object(c.useState)([]),v=Object(i.a)(x,2),g=v[0],S=v[1],I=Object(c.useState)([]),P=Object(i.a)(I,2),U=P[0],D=P[1],F=Object(c.useState)([]),k=Object(i.a)(F,2),A=k[0],E=k[1],R={SaleId:"",SaleDocNum:"",Store:"",POSNum:"",POSUser:n.user?n.user.Id:"",Paid:!1,SalesDetails:[]},T=Object(c.useState)(R),M=Object(i.a)(T,2),L=M[0],Q=M[1],q=Object(c.useState)([]),B=Object(i.a)(q,2),z=B[0],G=B[1],H=Object(c.useState)([]),_=Object(i.a)(H,2),V=_[0],J=_[1];function Y(){var e,t=null===(e=n.user)||void 0===e?void 0:e.Sales;if(null!==n.user&&void 0!==t)if(p(t),console.log("user sales updated"),t.length>0&&t.some((function(e){return!1===e.Paid}))){var c=t.find((function(e){return!1===e.Paid})),a=null===s||void 0===s?void 0:s.find((function(e){return e.SaleId===(null===c||void 0===c?void 0:c.SaleId)}));void 0!==a&&(Q(a),console.log("active sale updated"))}else null!==n.user&&function(e){try{C.Sales.create(e).then((function(e){null!==e&&Q(e)}))}catch(t){console.log(t)}}(R)}function W(){m.length>0&&(console.log("userSale count "+m.length),m.map((function(e){var t=null===j||void 0===j?void 0:j.find((function(t){return t.SaleId===e.SaleId}));console.log("Product found in User order: "+(null===t||void 0===t?void 0:t.Product)),void 0===t||z.some((function(e){return e.SalesDetailId===t.SalesDetailId}))||(G([].concat(Object(O.a)(z),[t])),console.log("User Sale Detail updated"))})))}function K(){(null===L||void 0===L?void 0:L.SalesDetails)!==[]&&(null===L||void 0===L||L.SalesDetails.map((function(e){var t=g.find((function(t){return t.ProductId===e.Product}));console.log("Product in Cart:"+(null===t||void 0===t?void 0:t.ProductName)),void 0===t||A.some((function(e){return e.ProductId===t.ProductId}))||(E([].concat(Object(O.a)(A),[t])),console.log("cart products updated"))})))}function X(){L.SalesDetails.length>0&&L.SalesDetails.map((function(e){var t=null===j||void 0===j?void 0:j.find((function(t){return t.SalesDetailId===e.SalesDetailId}));void 0===t||V.some((function(e){return e.SalesDetailId===t.SalesDetailId}))||(J([].concat(Object(O.a)(V),[t])),console.log("active cart product details with id: ".concat(t.Product," updated")))}))}return Object(c.useEffect)((function(){C.Sales.list().then((function(e){l(e)})).catch((function(e){console.log(e)})),C.SalesDetails.list().then((function(e){b(e)})).catch((function(e){console.log(e)})),C.Products.list().then((function(e){S(e)})).catch((function(e){console.log(e)})),C.Families.list().then((function(e){D(e)})).catch((function(e){console.log(e)}))}),[]),Object(c.useEffect)((function(){Y()}),[n.user]),Object(c.useEffect)((function(){K(),X()}),[L]),Object(c.useEffect)((function(){W()}),[m]),Object(y.jsx)(w.Provider,{value:{userSales:m,activeSale:L,setActiveSale:Q,userSalesDetails:z,setUserSalesDetails:G,activeSalesDetails:V,setActiveSalesDetails:J,products:g,setProducts:S,families:U,cartProducts:A,fillUserSales:Y,fillCartProducts:K,fillUserSalesDetails:W,fillActiveSalesDetails:X,clearCart:function(){p([]),E([]),Q(R),G([]),J([])}},children:t})}function A(e){var t,n,o=e.logout,r=a.a.useContext(N),O=a.a.useContext(w),f=Object(c.useState)("home"),m=Object(i.a)(f,2),p=m[0],x=m[1];function v(e){console.log(e);var t=e.target;x(t.name)}return Object(y.jsx)(u.a,{pointing:!0,secondary:!0,children:Object(y.jsxs)(s.a,{children:[Object(y.jsxs)(u.a.Item,{as:l.c,to:"/",exact:!0,header:!0,name:"home",active:"home"===p,onClick:v,children:[Object(y.jsx)(d.a,{name:"sun",size:"big",color:"orange"}),Object(y.jsx)(j.a,{as:"h3",color:"orange",children:"Garden Shop"})]}),r.userRoles.some((function(e){return"admin"===e.Name}))?Object(y.jsx)(u.a.Item,{as:l.c,to:"/store",name:"stores",active:"stores"===p,onClick:v}):Object(y.jsx)(y.Fragment,{}),Object(y.jsx)(u.a.Item,{as:l.c,to:"/product",name:"products",active:"products"===p,onClick:v}),Object(y.jsxs)(u.a.Menu,{position:"right",children:[Object(y.jsxs)(u.a.Item,{as:l.c,to:"/cartlist/".concat(null===(t=O.activeSale)||void 0===t?void 0:t.SaleId),name:"cartlist",onClick:v,children:[Object(y.jsx)(d.a,{disabled:null===r.user,name:"cart",size:"large",onClick:v}),0!=O.cartProducts.length?Object(y.jsx)(b.a,{color:"red",floating:!0,circular:!0,children:O.cartProducts.length}):Object(y.jsx)(y.Fragment,{})]}),null!==r.user?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsxs)(u.a.Item,{as:l.c,to:"/edituser/".concat(r.user.Id),name:"setting",onClick:v,children:[r.userPhotos.length>0?Object(y.jsx)(h.a,{src:null===(n=r.userPhotos.find((function(e){return e.IsMain})))||void 0===n?void 0:n.Url,avatar:!0}):Object(y.jsx)(y.Fragment,{}),r.user.UserName,Object(y.jsx)(d.a,{name:"setting",size:"large",style:{marginLeft:"10px"}})]}),Object(y.jsx)(u.a.Item,{name:"logout",active:"logout"===p,onClick:o})]}):Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(u.a.Item,{as:l.c,to:"/login",name:"login",active:"login"===p,onClick:v}),Object(y.jsx)(u.a.Item,{as:l.c,to:"/register",name:"register",active:"register"===p,onClick:v})]})]})]})})}var E=n(211),R=n(205);function T(e){var t=e.inverted,n=void 0===t||t,c=e.content,a=void 0===c?"Loading...":c;return Object(y.jsx)(E.a,{active:!0,inverted:n,children:Object(y.jsx)(R.a,{content:a})})}var M=n(210),L=n(192),Q=n(206);function q(){var e=a.a.useContext(N),t=Object(c.useState)(""),n=Object(i.a)(t,2),o=n[0],r=n[1],s=Object(c.useState)([]),u=Object(i.a)(s,2),b=u[0],h=u[1],f=Object(c.useState)(void 0),m=Object(i.a)(f,2),p=(m[0],m[1],Object(c.useState)(!1)),x=Object(i.a)(p,2),v=x[0],g=x[1];return Object(c.useEffect)((function(){C.Stores.list().then((function(e){console.log(e),h(e)}))}),[]),Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(j.a,{as:"h1",children:"Our stores"}),Object(y.jsx)(M.a.Group,{children:b.map((function(e){return Object(y.jsxs)(M.a,{children:[Object(y.jsxs)(M.a.Content,{children:[Object(y.jsx)(M.a.Header,{children:e.StoreName}),Object(y.jsx)(M.a.Meta,{children:e.StoreAddress}),Object(y.jsxs)(M.a.Description,{children:["The store is ",Object(y.jsx)("strong",{children:e.Active?"Active":"Inactive"})]})]}),Object(y.jsx)(M.a.Content,{extra:!0,children:Object(y.jsxs)("div",{className:"ui three buttons",children:[Object(y.jsx)(L.a,{color:"yellow",children:"View Stock"}),Object(y.jsx)(L.a,{as:l.b,to:"/editstore/".concat(e.Id),color:"green",children:"Edit"}),Object(y.jsx)(L.a,{name:e.Id,loading:v&&o===e.Id,onClick:function(t){return function(e,t){r(e.currentTarget.name),g(!0),C.Stores.delete(t).then((function(){h(Object(O.a)(b.filter((function(e){return e.Id!==t})))),g(!1)}))}(t,e.Id)},color:"orange",children:"Delete"})]})})]},e.Id)}))}),e.userRoles.some((function(e){return"admin"===e.Name}))?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(Q.a,{horizontal:!0,children:Object(y.jsxs)(j.a,{as:"h4",children:[Object(y.jsx)(d.a,{name:"edit outline"}),"New Store"]})}),Object(y.jsx)(M.a.Group,{centered:!0,children:Object(y.jsx)(L.a,{as:l.c,to:"/newstore",positive:!0,content:"Create Store"})})]}):Object(y.jsx)(y.Fragment,{})]})}var B=n(33),z=n(13),G=n(10),H=n(215),_=n(208);function V(){var e=Object(G.e)(),t=Object(G.f)().id,n=Object(c.useState)({Id:"",StoreName:"",StoreAddress:"",Active:!1,Pos:[],Stocks:[]}),a=Object(i.a)(n,2),o=a[0],r=a[1],s=Object(c.useState)(!1),l=Object(i.a)(s,2),u=l[0],d=l[1];function b(e){var t=e.target,n=t.name,c=t.value;r(Object(z.a)(Object(z.a)({},o),{},Object(B.a)({},n,c)))}return Object(c.useEffect)((function(){t&&C.Stores.details(t).then((function(e){null!==e&&r(e)})).catch((function(e){console.log(e)}))}),[t]),Object(y.jsx)(y.Fragment,{children:Object(y.jsx)(H.a,{centered:!0,columns:2,children:Object(y.jsxs)(H.a.Column,{children:[Object(y.jsx)(j.a,{as:"h2",children:"New store"}),Object(y.jsxs)(_.a,{onSubmit:function(){!function(t){d(!0),t.Id?C.Stores.update(t).then((function(){e.push("/store")})):C.Stores.create(t).then((function(){e.push("/store")}));r(t),d(!1)}(o)},children:[Object(y.jsx)(_.a.Input,{required:!0,placeholder:"Store Name",value:o.StoreName||"",name:"StoreName",onChange:b}),Object(y.jsx)(_.a.Input,{required:!0,placeholder:"Store Address",value:o.StoreAddress||"",name:"StoreAddress",onChange:b}),Object(y.jsx)(_.a.Checkbox,{label:"Active",checked:o.Active||!1,name:"Active",onChange:function(){r(Object(z.a)(Object(z.a)({},o),{},{Active:!o.Active}))}}),Object(y.jsx)(L.a,{loading:u,positive:!0,type:"submit",children:"Submit"}),Object(y.jsx)(L.a,{onClick:function(){e.push("/store")},type:"button",children:"Cancel"})]})]})})})}var J=n(37),Y=n.n(J),W=n(63),K=n(212);function X(){var e=a.a.useContext(N),t=Object(G.e)(),n=Object(c.useState)({UserName:"",Email:"",Password:""}),o=Object(i.a)(n,2),r=o[0],s=o[1],l=Object(c.useState)(!1),u=Object(i.a)(l,2),d=u[0],b=u[1],h=Object(c.useState)(""),O=Object(i.a)(h,2),f=O[0],m=O[1];function p(e){var t=e.target,n=t.name,c=t.value;s(Object(z.a)(Object(z.a)({},r),{},Object(B.a)({},n,c)))}function x(){return x=Object(W.a)(Y.a.mark((function n(c){var a;return Y.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,C.Account.login(c);case 3:a=n.sent,console.log(a),e.setUser(a),e.setToken(null===a||void 0===a?void 0:a.Token),b(!1),t.push("/"),n.next=16;break;case 11:n.prev=11,n.t0=n.catch(0),console.log(n.t0),m(n.t0),b(!1);case 16:case 17:case"end":return n.stop()}}),n,null,[[0,11]])}))),x.apply(this,arguments)}return Object(y.jsx)(y.Fragment,{children:Object(y.jsx)(H.a,{centered:!0,columns:2,children:Object(y.jsxs)(H.a.Column,{children:[Object(y.jsx)(j.a,{as:"h2",children:"Login"}),Object(y.jsxs)(_.a,{onSubmit:function(){b(!0),function(e){x.apply(this,arguments)}(r)},error:!!f,children:[Object(y.jsx)(_.a.Input,{required:!0,placeholder:"User Name",value:r.UserName||"",name:"UserName",onChange:p}),Object(y.jsx)(_.a.Input,{required:!0,placeholder:"Email",value:r.Email||"",name:"Email",onChange:p}),Object(y.jsx)(_.a.Input,{required:!0,type:"password",placeholder:"Password",value:r.Password||"",name:"Password",onChange:p}),Object(y.jsx)(L.a,{loading:d,positive:!0,type:"submit",children:"Login"}),Object(y.jsx)(L.a,{onClick:function(){t.push("/")},type:"button",children:"Cancel"}),Object(y.jsx)(K.a,{error:!0,content:f.toString()})]})]})})})}function Z(){var e=a.a.useContext(N);return Object(y.jsxs)(s.a,{children:[Object(y.jsx)(j.a,{as:"h2",children:"Home page"}),Object(y.jsx)(j.a,{as:"h4",block:!0,children:null===e.user?Object(y.jsxs)("p",{children:["Welcome to my Garden shop! Please ",Object(y.jsx)(l.b,{to:"/login",children:"login"})," to buy something. "]}):Object(y.jsxs)("p",{children:[Object(y.jsx)("strong",{children:e.user.UserName}),", welcome back to my Garden shop! Nice to see you again. "]})})]})}function $(){var e=a.a.useContext(N),t=Object(G.e)(),n=Object(c.useState)({UserName:"",Email:"",Password:""}),o=Object(i.a)(n,2),r=o[0],s=o[1],l=Object(c.useState)(!1),u=Object(i.a)(l,2),d=u[0],b=u[1],h=Object(c.useState)(""),O=Object(i.a)(h,2),f=O[0],m=O[1];function p(e){var t=e.target,n=t.name,c=t.value;s(Object(z.a)(Object(z.a)({},r),{},Object(B.a)({},n,c)))}function x(){return x=Object(W.a)(Y.a.mark((function n(c){var a;return Y.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,C.Account.register(c);case 3:a=n.sent,console.log(a),e.setUser(a),e.setToken(null===a||void 0===a?void 0:a.Token),b(!1),t.push("/"),n.next=16;break;case 11:n.prev=11,n.t0=n.catch(0),console.log(n.t0),m(n.t0.Message),b(!1);case 16:case 17:case"end":return n.stop()}}),n,null,[[0,11]])}))),x.apply(this,arguments)}return Object(y.jsx)(y.Fragment,{children:Object(y.jsx)(H.a,{centered:!0,columns:2,children:Object(y.jsxs)(H.a.Column,{children:[Object(y.jsx)(j.a,{as:"h2",children:"Register"}),Object(y.jsxs)(_.a,{onSubmit:function(){b(!0),function(e){x.apply(this,arguments)}(r)},error:!!f,children:[Object(y.jsx)(_.a.Input,{required:!0,placeholder:"User Name",value:r.UserName||"",name:"UserName",onChange:p}),Object(y.jsx)(_.a.Input,{required:!0,placeholder:"Email",value:r.Email||"",name:"Email",onChange:p}),Object(y.jsx)(_.a.Input,{required:!0,type:"password",placeholder:"Password",value:r.Password||"",name:"Password",onChange:p}),Object(y.jsx)(L.a,{loading:d,positive:!0,type:"submit",children:"Register"}),Object(y.jsx)(L.a,{onClick:function(){t.push("/")},type:"button",children:"Cancel"}),Object(y.jsx)(K.a,{error:!0,content:f.toString()})]})]})})})}function ee(){var e=a.a.useContext(N),t=a.a.useContext(w),n=Object(c.useState)(""),o=Object(i.a)(n,2),r=o[0],s=o[1],u=Object(c.useState)(void 0),h=Object(i.a)(u,2),f=(h[0],h[1]),m=Object(c.useState)(!1),p=Object(i.a)(m,2),x=p[0],v=p[1],g={SalesDetailId:"",SaleId:"",Seq:0,Product:"",Quantity:0,UnitPrice:0,LineTotal:0};function S(e,n){s(e.currentTarget.name),v(!0),f(n);var c,a=t.activeSalesDetails;if(a!==[]&&a.some((function(e){return e.Product===n.ProductId}))){var o=a.find((function(e){return e.Product===n.ProductId}));void 0!==o&&null!==o.UnitPrice&&(o.Quantity+=1,o.LineTotal+=o.UnitPrice?o.UnitPrice:0,c=o,C.SalesDetails.update(c),t.setActiveSalesDetails([].concat(Object(O.a)(a.filter((function(e){return e.SalesDetailId!==o.SalesDetailId}))),[o])))}else{var r=g;r.SaleId=null!==t.activeSale?t.activeSale.SaleId:"",r.Product=n.ProductId,r.UnitPrice=n.UnitPrice?n.UnitPrice:0,r.Quantity=1,r.LineTotal=n.UnitPrice?n.UnitPrice:0,function(e){C.SalesDetails.create(e).then((function(e){null!==e&&t.setActiveSalesDetails([].concat(Object(O.a)(t.activeSalesDetails),[e]))})).catch((function(e){console.log(e)}))}(r)}v(!1)}return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(j.a,{as:"h1",children:"Our products"}),Object(y.jsx)(M.a.Group,{children:t.products.map((function(n){var c,a;return Object(y.jsxs)(M.a,{children:[Object(y.jsxs)(M.a.Content,{children:[Object(y.jsx)(M.a.Header,{children:n.ProductName}),Object(y.jsxs)(M.a.Meta,{children:[Object(y.jsxs)("p",{children:["Barcode: ",n.Barcode]}),Object(y.jsxs)("p",{children:["Price: ",n.UnitPrice,"\u20ac per ",n.QuantityPerUnit," ",n.UnitMeasure]})]}),Object(y.jsxs)(M.a.Description,{children:[Object(y.jsxs)("p",{children:["The product is ",Object(y.jsx)("strong",{children:n.Discontinued?"discontinued":"available"})]}),Object(y.jsxs)(H.a,{children:[Object(y.jsx)(H.a.Column,{floated:"left",width:8,children:Object(y.jsx)(b.a,{children:null===(c=t.families.find((function(e){return e.FamilyId===n.FamilyId})))||void 0===c?void 0:c.FamilyName})}),Object(y.jsx)(H.a.Column,{floated:"right",width:7,children:t.activeSalesDetails.some((function(e){return e.Product===n.ProductId}))?Object(y.jsxs)(b.a,{color:"orange",children:["In cart: ",null===(a=t.activeSalesDetails.find((function(e){return e.Product===n.ProductId})))||void 0===a?void 0:a.Quantity," ",n.UnitMeasure]}):Object(y.jsx)(y.Fragment,{})})]})]})]}),Object(y.jsx)(M.a.Content,{extra:!0,children:e.userRoles.some((function(e){return"admin"===e.Name}))?Object(y.jsxs)("div",{className:"ui three buttons",children:[Object(y.jsx)(L.a,{color:"yellow",children:"View Stocks"}),Object(y.jsx)(L.a,{as:l.b,to:"/editproduct/".concat(n.ProductId),color:"green",children:"Edit"}),Object(y.jsx)(L.a,{name:n.ProductId,loading:x&&r===n.ProductId,onClick:function(e){return function(e,n){s(e.currentTarget.name),v(!0),C.Products.delete(n).then((function(){t.setProducts(Object(O.a)(t.products.filter((function(e){return e.ProductId!==n})))),v(!1)}))}(e,n.ProductId)},color:"red",children:"Delete"})]}):Object(y.jsxs)("div",{className:"ui two buttons",children:[Object(y.jsx)(L.a,{color:"yellow",children:"View Stocks"}),null!=e.user?Object(y.jsx)(L.a,{disabled:n.Discontinued,name:n.ProductId,loading:x&&r===n.ProductId,onClick:function(e){return S(e,n)},color:n.Discontinued?"grey":"green",children:"Add to cart"}):Object(y.jsx)(L.a,{as:l.c,to:"/login",name:"Login",color:"green",children:"Please login"})]})})]},n.ProductId)}))}),e.userRoles.some((function(e){return"admin"===e.Name}))?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(Q.a,{horizontal:!0,children:Object(y.jsxs)(j.a,{as:"h4",children:[Object(y.jsx)(d.a,{name:"edit outline"}),"New Product"]})}),Object(y.jsx)(M.a.Group,{centered:!0,children:Object(y.jsx)(L.a,{as:l.c,to:"/newproduct",positive:!0,content:"Create Product"})})]}):Object(y.jsx)(y.Fragment,{})]})}var te=n(216),ne=n(207);function ce(e){var t=e.currentFamily,n=e.setCurrentFamily,a=Object(c.useState)([]),o=Object(i.a)(a,2),r=o[0],s=o[1];Object(c.useEffect)((function(){C.Families.list().then((function(e){console.log(e),s(e)}))}),[]),Object(c.useEffect)((function(){var e=r.find((function(e){return e.FamilyName===t.FamilyName}));console.log("finded family: "+e),void 0!==e&&e.FamilyId!==t.FamilyId&&n(e)}),[r,t]);var l=Object(c.useState)(""),u=Object(i.a)(l,2),d=u[0],j=u[1],b=Object(c.useState)(!1),h=Object(i.a)(b,2),f=h[0],m=h[1];return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(_.a.Field,{label:"Family of the product",control:"select",value:t.FamilyName||"",onChange:function(e){var t=e.target.value,c=r.find((function(e){return e.FamilyName===t}));console.log((null===c||void 0===c?void 0:c.FamilyName)+" Selected"),void 0!==c&&n(c)},children:r.map((function(e){return Object(y.jsx)("option",{value:e.FamilyName,children:e.FamilyName},e.FamilyId)}))}),Object(y.jsxs)(te.a,{children:[Object(y.jsx)(ne.a,{placeholder:"Add Family",name:"Family",value:d||"",onChange:function(e){var t=e.target.value;j(t)}}),Object(y.jsx)(L.a,{loading:f,onClick:function(){var e;m(!0),e=d,r!==[]&&r.some((function(t){return t.FamilyName===e}))?console.log("Family ".concat(e," already exist")):C.Families.create({FamilyId:"",FamilyName:e,Products:[]}).then((function(e){null!==e&&(n(e),s([].concat(Object(O.a)(r),[e])))})).catch((function(e){console.log(e)})),m(!1)},type:"button",children:"Create family"})]})]})}function ae(){var e=Object(G.e)(),t=Object(G.f)().id,n=Object(c.useState)({ProductId:"",Barcode:"",ProductName:"",FamilyId:"",UnitMeasure:"piece",QuantityPerUnit:1,UnitPrice:null,Discontinued:!1,Stocks:[]}),a=Object(i.a)(n,2),o=a[0],r=a[1],s=Object(c.useState)({FamilyId:"",FamilyName:"unknown",Products:[]}),l=Object(i.a)(s,2),u=l[0],d=l[1],b=Object(c.useState)(!1),h=Object(i.a)(b,2),O=h[0],f=h[1];function m(e){var t=e.target,n=t.name,c=t.value;r(Object(z.a)(Object(z.a)({},o),{},Object(B.a)({},n,c)))}return Object(c.useEffect)((function(){t&&C.Products.details(t).then((function(e){null!==e&&r(e)})).catch((function(e){console.log(e)}))}),[t]),Object(c.useEffect)((function(){o.FamilyId!==u.FamilyId&&""!==u.FamilyId&&r(Object(z.a)(Object(z.a)({},o),{},{FamilyId:u.FamilyId}))}),[u]),Object(y.jsx)(y.Fragment,{children:Object(y.jsx)(H.a,{centered:!0,columns:2,children:Object(y.jsxs)(H.a.Column,{children:[Object(y.jsxs)(j.a,{as:"h2",children:[t?"Edit":"New"," product"]}),Object(y.jsxs)(_.a,{onSubmit:function(){!function(t){f(!0),t.ProductId?C.Products.update(t).then((function(){e.push("/product")})):C.Products.create(t).then((function(){e.push("/product")}));r(t),f(!1)}(o)},children:[Object(y.jsx)(_.a.Input,{required:!0,placeholder:"Product Name",value:o.ProductName||"",name:"ProductName",onChange:m}),Object(y.jsx)(_.a.Input,{placeholder:"Barcode",value:o.Barcode||"",name:"Barcode",onChange:m}),Object(y.jsx)(_.a.Input,{placeholder:"Product Price",value:o.UnitPrice||"",name:"UnitPrice",onChange:m}),Object(y.jsx)(_.a.Input,{placeholder:"Unit Measure",value:o.UnitMeasure||"",name:"UnitMeasure",onChange:m}),Object(y.jsx)(_.a.Input,{placeholder:"Quantity per Unit",value:o.QuantityPerUnit||"",name:"QuantityPerUnit",onChange:m}),Object(y.jsx)(_.a.Checkbox,{label:"Discontinued",checked:o.Discontinued||!1,name:"Discontinued",onChange:function(){r(Object(z.a)(Object(z.a)({},o),{},{Discontinued:!o.Discontinued}))}}),Object(y.jsx)(ce,{setCurrentFamily:d,currentFamily:u}),Object(y.jsx)(L.a,{loading:O,positive:!0,type:"submit",children:"Submit"}),Object(y.jsx)(L.a,{onClick:function(){e.push("/product")},type:"button",children:"Cancel"})]})]})})})}function oe(){var e=a.a.useContext(N),t=e.userRoles,n=(e.setUserRoles,e.roles),o=(e.setRoles,Object(G.e)()),r=Object(G.f)().id,s=Object(c.useState)({Id:"",UserName:"",Email:"",PhoneNumber:"",Address:"",City:"",Token:"",Sales:[],Photos:[],Roles:[]}),l=Object(i.a)(s,2),u=l[0],d=l[1],f=Object(c.useState)(!1),m=Object(i.a)(f,2),p=m[0],x=m[1],v=Object(c.useState)(""),g=Object(i.a)(v,2),S=g[0],I=g[1];Object(c.useEffect)((function(){r&&C.Users.details(r).then((function(e){null!==e&&d(e)})).catch((function(e){console.log(e),I(e)}))}),[r]);var P={Id:"",Name:""},U=Object(c.useState)(P),D=Object(i.a)(U,2),F=D[0],w=D[1],k=Object(c.useState)(null),A=Object(i.a)(k,2),E=A[0],R=A[1],T=Object(c.useState)([]),M=Object(i.a)(T,2),Q=M[0],q=M[1];function V(e){var t=e.target,n=t.name,c=t.value;d(Object(z.a)(Object(z.a)({},u),{},Object(B.a)({},n,c)))}function J(e){console.log(e);var n=e.target;if(""!==n.value&&!t.some((function(e){return e.Name===n.value}))){var c={Id:n.id,Name:n.value};w(c),d(Object(z.a)(Object(z.a)({},u),{},{Roles:[].concat(Object(O.a)(u.Roles),[c.Id])})),C.Roles.addrole(u.Id,c).then((function(e){null!==e&&d(e)})).catch((function(e){console.log(e),I(e)}))}}function X(e){console.log(e);var n=e.target;""!==n.value&&t.some((function(e){return e.Name===n.value}))&&(w(P),d(Object(z.a)(Object(z.a)({},u),{},{Roles:Object(O.a)(u.Roles.filter((function(e){return e!==n.id})))})))}function Z(e){try{C.Images.update(e).then((function(t){if(null!==t){var n=u;n.Photos=u.Photos.filter((function(t){return t.Id===e.Id||null===t.Id})),n.Photos.push(t),d(n),q([].concat(Object(O.a)(Q.filter((function(t){return t.Id===e.Id||null===t.Id}))),[t]))}}))}catch(S){console.log(S)}}function $(){return($=Object(W.a)(Y.a.mark((function e(t){var n,c;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.Images.upload(t);case 3:n=e.sent,c=n.data,ee({Id:c.PublicId,Url:c.Url,IsMain:0===u.Photos.length,UserId:u.Id,ProductId:""}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function ee(e){try{C.Images.create(e).then((function(e){if(null!==e){var t=u;t.Photos.push(e),d(t),q([].concat(Object(O.a)(Q),[e]))}}))}catch(S){console.log(S)}}function ce(){return ce=Object(W.a)(Y.a.mark((function e(t){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.Images.delete(t).then((function(){var e=u;e.Photos=u.Photos.filter((function(e){return e.Id!==t})),d(e),q(Q.filter((function(e){return e.Id!==t})))}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),ce.apply(this,arguments)}return Object(c.useEffect)((function(){var t=[];null===u||void 0===u||u.Photos.map((function(n){var c=e.photos.find((function(e){return e.Id===n.Id}));void 0===c||Q.some((function(e){return e.Id===n.Id}))||t.push(c)})),q(t)}),[u,e.photos]),Object(y.jsx)(y.Fragment,{children:Object(y.jsx)(H.a,{centered:!0,columns:2,children:Object(y.jsxs)(H.a.Column,{children:[Object(y.jsxs)(j.a,{as:"h2",children:['Edit user "',u.UserName,'"']}),Object(y.jsx)(te.a.Group,{children:Object(y.jsxs)(_.a,{onSubmit:function(){!function(e){x(!0),e.Id?C.Users.update(e).then((function(){o.push("/")})):C.Users.create(e).then((function(){o.push("/")}));d(e),x(!1)}(u)},error:!!S,children:[Object(y.jsxs)(te.a,{children:[Object(y.jsx)(_.a.Input,{required:!0,placeholder:"User Name",value:u.UserName||"",name:"UserName",onChange:V}),Object(y.jsx)(_.a.Input,{required:!0,placeholder:"Email",value:u.Email||"",name:"Email",onChange:V}),Object(y.jsx)(_.a.Input,{placeholder:"Phone Number",value:u.PhoneNumber||"",name:"PhoneNumber",onChange:V}),Object(y.jsx)(_.a.Input,{placeholder:"Address",value:u.Address||"",name:"Address",onChange:V}),Object(y.jsx)(_.a.Input,{placeholder:"City",value:u.City||"",name:"City",onChange:V})]}),Object(y.jsx)(te.a,{children:Object(y.jsxs)(H.a,{children:[Object(y.jsxs)(H.a.Row,{children:[Object(y.jsx)(H.a.Column,{width:8,children:Object(y.jsxs)(j.a,{as:"h4",children:['Roles of "',u.UserName,'":',Object(y.jsx)(j.a.Subheader,{children:"Click to remove ..."})]})}),Object(y.jsx)(H.a.Column,{width:8,children:t.map((function(e){return Object(y.jsx)(L.a,{size:"mini",type:"button",onClick:X,id:e.Id,value:e.Name,children:e.Name},e.Id)}))})]}),Object(y.jsxs)(H.a.Row,{children:[Object(y.jsx)(H.a.Column,{width:8,children:Object(y.jsxs)(j.a,{as:"h4",children:["Available Roles:",Object(y.jsx)(j.a.Subheader,{children:"Click to add ..."})]})}),Object(y.jsx)(H.a.Column,{width:8,children:n.map((function(e){return Object(y.jsx)(L.a,{size:"mini",type:"button",onClick:J,id:e.Id,value:e.Name,children:e.Name},e.Id)}))})]}),Object(y.jsx)(H.a.Row,{children:Object(y.jsxs)(H.a.Column,{width:16,children:[Object(y.jsx)(ne.a,{placeholder:"Add Role",name:"Role",value:F.Name||"",onChange:function(e){var t=e.target.value;w({Id:"",Name:t})}}),Object(y.jsx)(L.a,{loading:p,onClick:function(){""!==F.Id||n.some((function(e){return e.Name===F.Name}))||(x(!0),C.Roles.create({Name:F.Name}).then((function(e){null!==e&&w(e)})).catch((function(e){console.log(e),I(e)})),x(!1))},type:"button",children:"Create role"})]})})]})}),Object(y.jsxs)(te.a,{children:[Object(y.jsx)(L.a,{loading:p,positive:!0,type:"submit",children:"Submit"}),Object(y.jsx)(L.a,{onClick:function(){o.push("/")},type:"button",children:"Cancel"})]}),Object(y.jsxs)(te.a,{children:[Object(y.jsxs)(j.a,{as:"h4",children:[u.UserName,"'s images: "]}),Object(y.jsx)(h.a.Group,{size:"small",children:Q.map((function(e){return Object(y.jsxs)("div",{className:"image_container",children:[Object(y.jsx)(h.a,{src:e.Url,rounded:!0}),e.IsMain?Object(y.jsx)(b.a,{className:"image_label",color:"green",children:"Main photo"}):Object(y.jsx)(L.a,{loading:p,onClick:function(){return function(e){var t=u.Photos.find((function(e){return e.IsMain})),n=u.Photos.find((function(t){return t.Id===e}));t&&n&&(t.IsMain=!1,n.IsMain=!0,null!==t.Id&&Z(t),Z(n))}(e.Id)},type:"button",className:"image_label",children:"Set as Main"}),Object(y.jsx)(L.a,{loading:p,onClick:function(){return function(e){return ce.apply(this,arguments)}(e.Id)},type:"button",className:"image_delete",color:"orange",children:"Delete"})]},e.Id)}))}),Object(y.jsx)(j.a,{as:"h4",children:"Choose photo to upload: "}),Object(y.jsx)(ne.a,{type:"file",name:"file",onChange:function(e){R(e.target.files[0])}}),Object(y.jsx)(L.a,{disabled:null===E,onClick:function(){null!==E&&(!function(e){$.apply(this,arguments)}(E),R(null))},type:"button",style:{marginTop:"1em"},children:"Upload photo"})]}),Object(y.jsx)(K.a,{error:!0,content:S.toString()})]})})]})})})}function re(){var e=a.a.useContext(w),t=(a.a.useContext(N),Object(c.useState)(!1)),n=Object(i.a)(t,2),o=n[0],r=n[1],s=Object(c.useState)(0),l=Object(i.a)(s,2),u=l[0],d=l[1],h=Object(c.useState)(0),f=Object(i.a)(h,2),m=f[0],p=f[1];function x(t){var n=t.target,c=e.activeSalesDetails,a=c.find((function(e){return e.Product===n.value}));void 0!==a&&0!==a.UnitPrice&&(a.Quantity+=1,a.LineTotal+=a.UnitPrice,g(a),e.setActiveSalesDetails([].concat(Object(O.a)(c.filter((function(e){return e.SalesDetailId!==(null===a||void 0===a?void 0:a.SalesDetailId)}))),[a])),r(!1))}function v(t){var n=t.target,c=e.activeSalesDetails,a=c.find((function(e){return e.Product===n.value}));void 0!==a&&0!==a.UnitPrice&&a.Quantity>0&&(a.Quantity-=1,a.LineTotal-=a.UnitPrice,g(a),e.setActiveSalesDetails([].concat(Object(O.a)(c.filter((function(e){return e.SalesDetailId!==(null===a||void 0===a?void 0:a.SalesDetailId)}))),[a])),r(!1))}function g(e){return r(!0),C.SalesDetails.update(e)}return Object(c.useEffect)((function(){var t=0;e.activeSalesDetails.map((function(e){t+=e.LineTotal})),p(t),d(e.cartProducts.length)}),[e.activeSalesDetails,e.cartProducts]),Object(y.jsx)(y.Fragment,{children:u>0?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(j.a,{as:"h1",children:"Your Cart"}),Object(y.jsxs)(H.a,{children:[Object(y.jsx)(H.a.Column,{width:10,children:e.cartProducts.map((function(t){var n,c,a,r;return Object(y.jsx)(M.a,{fluid:!0,children:Object(y.jsxs)(M.a.Content,{children:[Object(y.jsx)(M.a.Header,{as:"h2",children:t.ProductName}),Object(y.jsxs)(M.a.Meta,{children:["    ",Object(y.jsxs)("p",{children:["Barcode: ",t.Barcode]})]}),Object(y.jsxs)(M.a.Description,{children:[Object(y.jsxs)(H.a,{children:[Object(y.jsx)(H.a.Column,{floated:"left",width:10,children:Object(y.jsxs)("p",{children:["Price: ",t.UnitPrice,"\u20ac per ",t.QuantityPerUnit," ",t.UnitMeasure]})}),Object(y.jsx)(H.a.Column,{floated:"right",width:6,children:Object(y.jsxs)("strong",{children:["Total: ",null===(n=e.activeSalesDetails)||void 0===n||null===(c=n.find((function(e){return e.Product===t.ProductId})))||void 0===c?void 0:c.LineTotal,"\u20ac "]})})]}),Object(y.jsx)(b.a,{children:null===(a=e.families.find((function(e){return e.FamilyId===t.FamilyId})))||void 0===a?void 0:a.FamilyName}),Object(y.jsxs)(L.a.Group,{size:"large",floated:"right",children:[Object(y.jsx)(L.a,{loading:o,negative:!0,onClick:v,type:"button",value:t.ProductId,children:"-"}),Object(y.jsxs)(L.a,{children:[null===(r=e.activeSalesDetails.find((function(e){return e.Product===t.ProductId})))||void 0===r?void 0:r.Quantity," ",t.UnitMeasure]}),Object(y.jsx)(L.a,{loading:o,positive:!0,onClick:x,type:"button",value:t.ProductId,children:"+"})]})]})]})},t.ProductId)}))}),Object(y.jsx)(H.a.Column,{width:6,children:Object(y.jsxs)(te.a,{children:[Object(y.jsx)(j.a,{as:"h2",children:"Total:"}),Object(y.jsxs)("p",{children:[u," units for ",m,"\u20ac"]})]})})]})]}):Object(y.jsx)(j.a,{as:"h1",children:"Your Cart is empty"})})}var ie=function(){var e=a.a.useContext(N),t=a.a.useContext(w),n=Object(G.e)(),o=Object(c.useState)(!0),r=Object(i.a)(o,2),l=r[0],u=r[1];return Object(c.useEffect)((function(){e.userToken?(console.log("the token: "+e.userToken),e.getCurrentUser(),e.user&&(t.fillUserSales(),t.fillCartProducts(),t.fillUserSalesDetails(),t.fillActiveSalesDetails()),u(!1)):u(!1)}),[]),l?Object(y.jsx)(T,{content:"Loading App ..."}):Object(y.jsxs)("div",{className:"App",children:[Object(y.jsx)(A,{logout:function(){e.setUser(null),t.clearCart(),window.localStorage.removeItem("jwt"),console.log("Successfully loged out"),n.push("/")}}),Object(y.jsxs)(s.a,{style:{marginTop:"5em"},children:[Object(y.jsx)(G.a,{exact:!0,path:"/",component:Z}),Object(y.jsx)(G.a,{path:"/store",component:q}),Object(y.jsx)(G.a,{path:["/newstore","/editstore/:id"],component:V}),Object(y.jsx)(G.a,{path:"/product",component:ee}),Object(y.jsx)(G.a,{path:["/newproduct","/editproduct/:id"],component:ae}),Object(y.jsx)(G.a,{path:["/newuser","/edituser/:id"],component:oe}),Object(y.jsx)(G.a,{path:"/cartlist/:id",component:re}),Object(y.jsx)(G.a,{path:"/login",component:X}),Object(y.jsx)(G.a,{path:"/register",component:$})]})]})},se=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,217)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),c(e),a(e),o(e),r(e)}))};r.a.render(Object(y.jsx)(D,{children:Object(y.jsx)(k,{children:Object(y.jsx)(l.a,{children:Object(y.jsx)(ie,{})})})}),document.getElementById("root")),se()}},[[191,1,2]]]);
//# sourceMappingURL=main.f9688d0f.chunk.js.map