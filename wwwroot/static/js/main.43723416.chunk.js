(this["webpackJsonpclient-app"]=this["webpackJsonpclient-app"]||[]).push([[0],{163:function(e,t,n){},191:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),r=n(59),o=n.n(r),i=(n(162),n(163),n(8)),s=n(204),l=n(16),u=n(209),d=n(64),j=n(213),b=n(15),O=n(56),h=n.n(O);h.a.defaults.baseURL="/api",h.a.interceptors.request.use((function(e){var t=window.localStorage.getItem("jwt");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}));var f=function(e){return e.status<300?e.data:null},m=function(e){return e.status<300?e.data:[]},x=function(e){return h.a.get(e).then(f)},v=function(e){return h.a.get(e).then(m)},p=function(e,t){return h.a.post(e,t).then(f)},g=function(e,t){return h.a.put(e,t).then(f)},S=function(e){return h.a.delete(e).then(f)},P={Stores:{list:function(){return v("/store")},details:function(e){return x("/store/".concat(e))},create:function(e){return p("/store",e)},update:function(e){return g("/store/".concat(e.Id),e)},delete:function(e){return S("/store/".concat(e))}},Sales:{list:function(){return v("/sale")},details:function(e){return x("/sale/".concat(e))},create:function(e){return p("/sale",e)},update:function(e){return g("/sale/".concat(e.SaleId),e)},delete:function(e){return S("/sale/".concat(e))}},SalesDetails:{list:function(){return v("/salesdetail")},details:function(e){return x("/salesdetail/".concat(e))},create:function(e){return p("/salesdetail",e)},update:function(e){return g("/salesdetail/".concat(e.SalesDetailId),e)},delete:function(e){return S("/salesdetail/".concat(e))}},Products:{list:function(){return v("/product")},details:function(e){return x("/product/".concat(e))},create:function(e){return p("/product",e)},update:function(e){return g("/product/".concat(e.ProductId),e)},delete:function(e){return S("/product/".concat(e))}},Families:{list:function(){return v("/family")},details:function(e){return x("/family/".concat(e))},create:function(e){return p("/family",e)},update:function(e){return g("/family/".concat(e.FamilyId),e)},delete:function(e){return S("/family/".concat(e))}},Users:{current:function(){return x("/user")},details:function(e){return x("/user/".concat(e))},create:function(e){return p("/user",e)},update:function(e){return g("/user/".concat(e.Id),e)},delete:function(e){return S("/user/".concat(e))}},Roles:{list:function(){return v("/user/role")},details:function(e){return x("/user/role/".concat(e))},create:function(e){return p("/user/role",e)},addrole:function(e,t){return p("/user/role/".concat(e),t)},delete:function(e){return S("/user/role/".concat(e))}},Account:{current:function(){return x("/account")},login:function(e){return p("/login",e)},register:function(e){return p("/register",e)},logout:function(){return x("/logout")}}},I=n(1),C={user:null,setUser:null,userRoles:[],setUserRoles:null,roles:[],setRoles:null,userToken:null,setToken:null,getCurrentUser:null},y=Object(c.createContext)(C);function U(e){var t=e.children,n=Object(c.useState)(null),a=Object(i.a)(n,2),r=a[0],o=a[1],s=Object(c.useState)([]),l=Object(i.a)(s,2),u=l[0],d=l[1],j=Object(c.useState)([]),O=Object(i.a)(j,2),h=O[0],f=O[1],m=Object(c.useState)(window.localStorage.getItem("jwt")),x=Object(i.a)(m,2),v=x[0],p=x[1];return Object(c.useEffect)((function(){P.Roles.list().then((function(e){null!==e&&d(e)})).catch((function(e){console.log(e)}))}),[]),Object(c.useEffect)((function(){f([]),null===r||void 0===r||r.Roles.map((function(e){var t=u.find((function(t){return t.Id===e}));void 0===t||h.some((function(t){return t.Id===e}))||f([].concat(Object(b.a)(h),[t]))}))}),[r,u]),Object(I.jsx)(y.Provider,{value:{user:r,setUser:o,userRoles:h,setUserRoles:f,roles:u,setRoles:d,userToken:v,setToken:function(e){e&&(window.localStorage.setItem("jwt",e),p(e))},getCurrentUser:function(){null!==v&&(console.log("Trying to get user ..."),P.Users.current().then((function(e){console.log(e),o(e)})).catch((function(e){console.log(e)})))}},children:t})}var N={userSales:[],activeSale:null,setActiveSale:null,userSalesDetails:[],setUserSalesDetails:null,activeSalesDetails:[],setActiveSalesDetails:null,products:[],setProducts:null,families:[],cartProducts:[],fillUserSales:null,fillCartProducts:null,fillUserSalesDetails:null,fillActiveSalesDetails:null},D=Object(c.createContext)(N);function F(e){var t=e.children,n=a.a.useContext(y),r=Object(c.useState)(null),o=Object(i.a)(r,2),s=o[0],l=o[1],u=Object(c.useState)(null),d=Object(i.a)(u,2),j=d[0],O=d[1],h=Object(c.useState)([]),f=Object(i.a)(h,2),m=f[0],x=f[1],v=Object(c.useState)([]),p=Object(i.a)(v,2),g=p[0],S=p[1],C=Object(c.useState)([]),U=Object(i.a)(C,2),N=U[0],F=U[1],w=Object(c.useState)([]),k=Object(i.a)(w,2),A=k[0],E=k[1],R={SaleId:"",SaleDocNum:"",Store:"",POSNum:"",POSUser:n.user?n.user.Id:"",Paid:!1,SalesDetails:[]},T=Object(c.useState)(R),L=Object(i.a)(T,2),Q=L[0],q=L[1],M=Object(c.useState)([]),B=Object(i.a)(M,2),z=B[0],G=B[1],H=Object(c.useState)([]),V=Object(i.a)(H,2),J=V[0],Y=V[1];function W(){var e,t=null===(e=n.user)||void 0===e?void 0:e.Sales;if(null!==n.user&&void 0!==t)if(x(t),console.log("user sales updated"),t.length>0&&t.some((function(e){return!1===e.Paid}))){var c=t.find((function(e){return!1===e.Paid})),a=null===s||void 0===s?void 0:s.find((function(e){return e.SaleId===(null===c||void 0===c?void 0:c.SaleId)}));void 0!==a&&(q(a),console.log("active sale updated"))}else null!==n.user&&function(e){try{P.Sales.create(e).then((function(e){null!==e&&q(e)}))}catch(t){console.log(t)}}(R)}function K(){m.length>0&&(console.log("userSale count "+m.length),z.length>0&&G([]),m.map((function(e){var t=null===j||void 0===j?void 0:j.find((function(t){return t.SaleID===e.SaleId}));console.log("Product found in User order: "+(null===t||void 0===t?void 0:t.Product)),void 0!==t&&G([].concat(Object(b.a)(z),[t]))})))}function X(){(null===Q||void 0===Q?void 0:Q.SalesDetails)!==[]&&(A.length>0&&E([]),null===Q||void 0===Q||Q.SalesDetails.map((function(e){var t=g.find((function(t){return t.ProductId===e.Product}));console.log("Product in Cart:"+(null===t||void 0===t?void 0:t.ProductName)),void 0===t||A.some((function(e){return e.ProductId===t.ProductId}))||(E([].concat(Object(b.a)(A),[t])),console.log("cart products updated"))})))}function Z(){Q.SalesDetails.length>0&&(J.length>0&&Y([]),Q.SalesDetails.map((function(e){var t=null===j||void 0===j?void 0:j.find((function(t){return t.SalesDetailId===e.SalesDetailId}));void 0!==t&&(Y([].concat(Object(b.a)(J),[t])),console.log("active cart product details with id: ".concat(t.Product," updated")))})))}return Object(c.useEffect)((function(){P.Sales.list().then((function(e){l(e)})).catch((function(e){console.log(e)})),P.SalesDetails.list().then((function(e){O(e)})).catch((function(e){console.log(e)})),P.Products.list().then((function(e){S(e)})).catch((function(e){console.log(e)})),P.Families.list().then((function(e){F(e)})).catch((function(e){console.log(e)}))}),[]),Object(c.useEffect)((function(){W()}),[n.user]),Object(c.useEffect)((function(){K(),Z(),X()}),[Q,q]),Object(I.jsx)(D.Provider,{value:{userSales:m,activeSale:Q,setActiveSale:q,userSalesDetails:z,setUserSalesDetails:G,activeSalesDetails:J,setActiveSalesDetails:Y,products:g,setProducts:S,families:N,cartProducts:A,fillUserSales:W,fillCartProducts:X,fillUserSalesDetails:K,fillActiveSalesDetails:Z},children:t})}function w(e){var t,n=e.logout,r=a.a.useContext(y),o=a.a.useContext(D),b=Object(c.useState)("home"),O=Object(i.a)(b,2),h=O[0],f=O[1];function m(e){console.log(e);var t=e.target;f(t.name)}return Object(I.jsx)(u.a,{pointing:!0,secondary:!0,children:Object(I.jsxs)(s.a,{children:[Object(I.jsxs)(u.a.Item,{as:l.c,to:"/",exact:!0,header:!0,name:"home",active:"home"===h,onClick:m,children:[Object(I.jsx)(d.a,{name:"sun",size:"big",color:"orange"}),Object(I.jsx)(j.a,{as:"h3",color:"orange",children:"Garden Shop"})]}),r.userRoles.some((function(e){return"admin"===e.Name}))?Object(I.jsx)(u.a.Item,{as:l.c,to:"/store",name:"stores",active:"stores"===h,onClick:m}):Object(I.jsx)(I.Fragment,{}),Object(I.jsx)(u.a.Item,{as:l.c,to:"/product",name:"products",active:"products"===h,onClick:m}),Object(I.jsxs)(u.a.Menu,{position:"right",children:[Object(I.jsx)(u.a.Item,{as:l.c,to:"/cartlist/".concat(null===(t=o.activeSale)||void 0===t?void 0:t.SaleId),name:"cartlist",onClick:m,children:Object(I.jsx)(d.a,{disabled:null===r.user,name:"cart",size:"large",onClick:m})}),null!==r.user?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)(u.a.Item,{as:l.c,to:"/edituser/".concat(r.user.Id),name:"setting",onClick:m,children:[r.user.UserName,Object(I.jsx)(d.a,{name:"setting",size:"large",style:{marginLeft:"10px"}})]}),Object(I.jsx)(u.a.Item,{name:"logout",active:"logout"===h,onClick:n})]}):Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(u.a.Item,{as:l.c,to:"/login",name:"login",active:"login"===h,onClick:m}),Object(I.jsx)(u.a.Item,{as:l.c,to:"/register",name:"register",active:"register"===h,onClick:m})]})]})]})})}var k=n(211),A=n(205);function E(e){var t=e.inverted,n=void 0===t||t,c=e.content,a=void 0===c?"Loading...":c;return Object(I.jsx)(k.a,{active:!0,inverted:n,children:Object(I.jsx)(A.a,{content:a})})}var R=n(210),T=n(192),L=n(206);function Q(){var e=a.a.useContext(y),t=Object(c.useState)(""),n=Object(i.a)(t,2),r=n[0],o=n[1],s=Object(c.useState)([]),u=Object(i.a)(s,2),O=u[0],h=u[1],f=Object(c.useState)(void 0),m=Object(i.a)(f,2),x=(m[0],m[1],Object(c.useState)(!1)),v=Object(i.a)(x,2),p=v[0],g=v[1];return Object(c.useEffect)((function(){P.Stores.list().then((function(e){console.log(e),h(e)}))}),[]),Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(j.a,{as:"h1",children:"Our stores"}),Object(I.jsx)(R.a.Group,{children:O.map((function(e){return Object(I.jsxs)(R.a,{children:[Object(I.jsxs)(R.a.Content,{children:[Object(I.jsx)(R.a.Header,{children:e.StoreName}),Object(I.jsx)(R.a.Meta,{children:e.StoreAddress}),Object(I.jsxs)(R.a.Description,{children:["The store is ",Object(I.jsx)("strong",{children:e.Active?"Active":"Inactive"})]})]}),Object(I.jsx)(R.a.Content,{extra:!0,children:Object(I.jsxs)("div",{className:"ui three buttons",children:[Object(I.jsx)(T.a,{color:"yellow",children:"View Stock"}),Object(I.jsx)(T.a,{as:l.b,to:"/editstore/".concat(e.Id),color:"green",children:"Edit"}),Object(I.jsx)(T.a,{name:e.Id,loading:p&&r===e.Id,onClick:function(t){return function(e,t){o(e.currentTarget.name),g(!0),P.Stores.delete(t).then((function(){h(Object(b.a)(O.filter((function(e){return e.Id!==t})))),g(!1)}))}(t,e.Id)},color:"orange",children:"Delete"})]})})]},e.Id)}))}),e.userRoles.some((function(e){return"admin"===e.Name}))?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(L.a,{horizontal:!0,children:Object(I.jsxs)(j.a,{as:"h4",children:[Object(I.jsx)(d.a,{name:"edit outline"}),"New Store"]})}),Object(I.jsx)(R.a.Group,{centered:!0,children:Object(I.jsx)(T.a,{as:l.c,to:"/newstore",positive:!0,content:"Create Store"})})]}):Object(I.jsx)(I.Fragment,{})]})}var q=n(33),M=n(13),B=n(10),z=n(215),G=n(208);function H(){var e=Object(B.e)(),t=Object(B.f)().id,n=Object(c.useState)({Id:"",StoreName:"",StoreAddress:"",Active:!1,Pos:[],Stocks:[]}),a=Object(i.a)(n,2),r=a[0],o=a[1],s=Object(c.useState)(!1),l=Object(i.a)(s,2),u=l[0],d=l[1];function b(e){var t=e.target,n=t.name,c=t.value;o(Object(M.a)(Object(M.a)({},r),{},Object(q.a)({},n,c)))}return Object(c.useEffect)((function(){t&&P.Stores.details(t).then((function(e){null!==e&&o(e)})).catch((function(e){console.log(e)}))}),[t]),Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(z.a,{centered:!0,columns:2,children:Object(I.jsxs)(z.a.Column,{children:[Object(I.jsx)(j.a,{as:"h2",children:"New store"}),Object(I.jsxs)(G.a,{onSubmit:function(){!function(t){d(!0),t.Id?P.Stores.update(t).then((function(){e.push("/store")})):P.Stores.create(t).then((function(){e.push("/store")}));o(t),d(!1)}(r)},children:[Object(I.jsx)(G.a.Input,{required:!0,placeholder:"Store Name",value:r.StoreName||"",name:"StoreName",onChange:b}),Object(I.jsx)(G.a.Input,{required:!0,placeholder:"Store Address",value:r.StoreAddress||"",name:"StoreAddress",onChange:b}),Object(I.jsx)(G.a.Checkbox,{label:"Active",checked:r.Active||!1,name:"Active",onChange:function(){o(Object(M.a)(Object(M.a)({},r),{},{Active:!r.Active}))}}),Object(I.jsx)(T.a,{loading:u,positive:!0,type:"submit",children:"Submit"}),Object(I.jsx)(T.a,{onClick:function(){e.push("/store")},type:"button",children:"Cancel"})]})]})})})}var V=n(85),J=n.n(V),Y=n(111),W=n(212);function K(){var e=a.a.useContext(y),t=Object(B.e)(),n=Object(c.useState)({UserName:"",Email:"",Password:""}),r=Object(i.a)(n,2),o=r[0],s=r[1],l=Object(c.useState)(!1),u=Object(i.a)(l,2),d=u[0],b=u[1],O=Object(c.useState)(""),h=Object(i.a)(O,2),f=h[0],m=h[1];function x(e){var t=e.target,n=t.name,c=t.value;s(Object(M.a)(Object(M.a)({},o),{},Object(q.a)({},n,c)))}function v(){return v=Object(Y.a)(J.a.mark((function n(c){var a;return J.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,P.Account.login(c);case 3:a=n.sent,console.log(a),e.setUser(a),e.setToken(null===a||void 0===a?void 0:a.Token),b(!1),t.push("/"),n.next=16;break;case 11:n.prev=11,n.t0=n.catch(0),console.log(n.t0),m(n.t0),b(!1);case 16:case 17:case"end":return n.stop()}}),n,null,[[0,11]])}))),v.apply(this,arguments)}return Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(z.a,{centered:!0,columns:2,children:Object(I.jsxs)(z.a.Column,{children:[Object(I.jsx)(j.a,{as:"h2",children:"Login"}),Object(I.jsxs)(G.a,{onSubmit:function(){b(!0),function(e){v.apply(this,arguments)}(o)},error:!!f,children:[Object(I.jsx)(G.a.Input,{required:!0,placeholder:"User Name",value:o.UserName||"",name:"UserName",onChange:x}),Object(I.jsx)(G.a.Input,{required:!0,placeholder:"Email",value:o.Email||"",name:"Email",onChange:x}),Object(I.jsx)(G.a.Input,{required:!0,type:"password",placeholder:"Password",value:o.Password||"",name:"Password",onChange:x}),Object(I.jsx)(T.a,{loading:d,positive:!0,type:"submit",children:"Login"}),Object(I.jsx)(T.a,{onClick:function(){t.push("/")},type:"button",children:"Cancel"}),Object(I.jsx)(W.a,{error:!0,content:f.toString()})]})]})})})}function X(){var e=a.a.useContext(y);return Object(I.jsxs)(s.a,{children:[Object(I.jsx)(j.a,{as:"h2",children:"Home page"}),Object(I.jsx)(j.a,{as:"h4",block:!0,children:null===e.user?Object(I.jsxs)("p",{children:["Welcome to my Garden shop! Please ",Object(I.jsx)(l.b,{to:"/login",children:"login"})," to buy something. "]}):Object(I.jsxs)("p",{children:[Object(I.jsx)("strong",{children:e.user.UserName}),", welcome back to my Garden shop! Nice to see you again. "]})})]})}function Z(){var e=a.a.useContext(y),t=Object(B.e)(),n=Object(c.useState)({UserName:"",Email:"",Password:""}),r=Object(i.a)(n,2),o=r[0],s=r[1],l=Object(c.useState)(!1),u=Object(i.a)(l,2),d=u[0],b=u[1],O=Object(c.useState)(""),h=Object(i.a)(O,2),f=h[0],m=h[1];function x(e){var t=e.target,n=t.name,c=t.value;s(Object(M.a)(Object(M.a)({},o),{},Object(q.a)({},n,c)))}function v(){return v=Object(Y.a)(J.a.mark((function n(c){var a;return J.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,P.Account.register(c);case 3:a=n.sent,console.log(a),e.setUser(a),e.setToken(null===a||void 0===a?void 0:a.Token),b(!1),t.push("/"),n.next=16;break;case 11:n.prev=11,n.t0=n.catch(0),console.log(n.t0),m(n.t0.Message),b(!1);case 16:case 17:case"end":return n.stop()}}),n,null,[[0,11]])}))),v.apply(this,arguments)}return Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(z.a,{centered:!0,columns:2,children:Object(I.jsxs)(z.a.Column,{children:[Object(I.jsx)(j.a,{as:"h2",children:"Register"}),Object(I.jsxs)(G.a,{onSubmit:function(){b(!0),function(e){v.apply(this,arguments)}(o)},error:!!f,children:[Object(I.jsx)(G.a.Input,{required:!0,placeholder:"User Name",value:o.UserName||"",name:"UserName",onChange:x}),Object(I.jsx)(G.a.Input,{required:!0,placeholder:"Email",value:o.Email||"",name:"Email",onChange:x}),Object(I.jsx)(G.a.Input,{required:!0,type:"password",placeholder:"Password",value:o.Password||"",name:"Password",onChange:x}),Object(I.jsx)(T.a,{loading:d,positive:!0,type:"submit",children:"Register"}),Object(I.jsx)(T.a,{onClick:function(){t.push("/")},type:"button",children:"Cancel"}),Object(I.jsx)(W.a,{error:!0,content:f.toString()})]})]})})})}var $=n(90);function _(){var e=a.a.useContext(y),t=a.a.useContext(D),n=Object(c.useState)(""),r=Object(i.a)(n,2),o=r[0],s=r[1],u=Object(c.useState)(void 0),O=Object(i.a)(u,2),h=(O[0],O[1]),f=Object(c.useState)(!1),m=Object(i.a)(f,2),x=m[0],v=m[1],p={SalesDetailId:"",SaleID:"",Seq:0,Product:"",Quantity:0,UnitPrice:0,LineTotal:0};function g(e,n){s(e.currentTarget.name),v(!0),h(n);var c,a=t.activeSalesDetails;if(a!==[]&&a.some((function(e){return e.Product===n.ProductId}))){var r=a.find((function(e){return e.Product===n.ProductId}));void 0!==r&&null!==r.UnitPrice&&(r.Quantity+=1,r.LineTotal+=r.UnitPrice?r.UnitPrice:0,c=r,P.SalesDetails.update(c),t.setActiveSalesDetails([].concat(Object(b.a)(a.filter((function(e){return e.SalesDetailId!==r.SalesDetailId}))),[r])))}else{var o=p;o.SaleID=null!==t.activeSale?t.activeSale.SaleId:"",o.Product=n.ProductId,o.UnitPrice=n.UnitPrice?n.UnitPrice:0,o.Quantity=1,o.LineTotal=n.UnitPrice?n.UnitPrice:0,function(e){P.SalesDetails.create(e).then((function(e){null!==e&&t.setActiveSalesDetails([].concat(Object(b.a)(t.activeSalesDetails),[e]))})).catch((function(e){console.log(e)}))}(o)}v(!1)}return Object(c.useEffect)((function(){e.user&&(t.fillUserSales(),t.fillCartProducts(),t.fillUserSalesDetails(),t.fillActiveSalesDetails())}),[]),Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(j.a,{as:"h1",children:"Our products"}),Object(I.jsx)(R.a.Group,{children:t.products.map((function(n){var c,a;return Object(I.jsxs)(R.a,{children:[Object(I.jsxs)(R.a.Content,{children:[Object(I.jsx)(R.a.Header,{children:n.ProductName}),Object(I.jsxs)(R.a.Meta,{children:[Object(I.jsxs)("p",{children:["Barcode: ",n.Barcode]}),Object(I.jsxs)("p",{children:["Price: ",n.UnitPrice,"\u20ac per ",n.QuantityPerUnit," ",n.UnitMeasure]})]}),Object(I.jsxs)(R.a.Description,{children:[Object(I.jsxs)("p",{children:["The product is ",Object(I.jsx)("strong",{children:n.Discontinued?"discontinued":"available"})]}),Object(I.jsxs)(z.a,{children:[Object(I.jsx)(z.a.Column,{floated:"left",width:8,children:Object(I.jsx)($.a,{children:null===(c=t.families.find((function(e){return e.FamilyId===n.FamilyId})))||void 0===c?void 0:c.FamilyName})}),Object(I.jsx)(z.a.Column,{floated:"right",width:7,children:t.activeSalesDetails.some((function(e){return e.Product===n.ProductId}))?Object(I.jsxs)($.a,{color:"orange",children:["In cart: ",null===(a=t.activeSalesDetails.find((function(e){return e.Product===n.ProductId})))||void 0===a?void 0:a.Quantity," ",n.UnitMeasure]}):Object(I.jsx)(I.Fragment,{})})]})]})]}),Object(I.jsx)(R.a.Content,{extra:!0,children:e.userRoles.some((function(e){return"admin"===e.Name}))?Object(I.jsxs)("div",{className:"ui three buttons",children:[Object(I.jsx)(T.a,{color:"yellow",children:"View Stocks"}),Object(I.jsx)(T.a,{as:l.b,to:"/editproduct/".concat(n.ProductId),color:"green",children:"Edit"}),Object(I.jsx)(T.a,{name:n.ProductId,loading:x&&o===n.ProductId,onClick:function(e){return function(e,n){s(e.currentTarget.name),v(!0),P.Products.delete(n).then((function(){t.setProducts(Object(b.a)(t.products.filter((function(e){return e.ProductId!==n})))),v(!1)}))}(e,n.ProductId)},color:"red",children:"Delete"})]}):Object(I.jsxs)("div",{className:"ui two buttons",children:[Object(I.jsx)(T.a,{color:"yellow",children:"View Stocks"}),null!=e.user?Object(I.jsx)(T.a,{disabled:n.Discontinued,name:n.ProductId,loading:x&&o===n.ProductId,onClick:function(e){return g(e,n)},color:n.Discontinued?"grey":"green",children:"Add to cart"}):Object(I.jsx)(T.a,{as:l.c,to:"/login",name:"Login",color:"green",children:"Please login"})]})})]},n.ProductId)}))}),e.userRoles.some((function(e){return"admin"===e.Name}))?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(L.a,{horizontal:!0,children:Object(I.jsxs)(j.a,{as:"h4",children:[Object(I.jsx)(d.a,{name:"edit outline"}),"New Product"]})}),Object(I.jsx)(R.a.Group,{centered:!0,children:Object(I.jsx)(T.a,{as:l.c,to:"/newproduct",positive:!0,content:"Create Product"})})]}):Object(I.jsx)(I.Fragment,{})]})}var ee=n(216),te=n(207);function ne(e){var t=e.currentFamily,n=e.setCurrentFamily,a=Object(c.useState)([]),r=Object(i.a)(a,2),o=r[0],s=r[1];Object(c.useEffect)((function(){P.Families.list().then((function(e){console.log(e),s(e)}))}),[]),Object(c.useEffect)((function(){var e=o.find((function(e){return e.FamilyName===t.FamilyName}));console.log("finded family: "+e),void 0!==e&&e.FamilyId!==t.FamilyId&&n(e)}),[o,t]);var l=Object(c.useState)(""),u=Object(i.a)(l,2),d=u[0],j=u[1],O=Object(c.useState)(!1),h=Object(i.a)(O,2),f=h[0],m=h[1];return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(G.a.Field,{label:"Family of the product",control:"select",value:t.FamilyName||"",onChange:function(e){var t=e.target.value,c=o.find((function(e){return e.FamilyName===t}));console.log((null===c||void 0===c?void 0:c.FamilyName)+" Selected"),void 0!==c&&n(c)},children:o.map((function(e){return Object(I.jsx)("option",{value:e.FamilyName,children:e.FamilyName},e.FamilyId)}))}),Object(I.jsxs)(ee.a,{children:[Object(I.jsx)(te.a,{placeholder:"Add Family",name:"Family",value:d||"",onChange:function(e){var t=e.target.value;j(t)}}),Object(I.jsx)(T.a,{loading:f,onClick:function(){var e;m(!0),e=d,o!==[]&&o.some((function(t){return t.FamilyName===e}))?console.log("Family ".concat(e," already exist")):P.Families.create({FamilyId:"",FamilyName:e,Products:[]}).then((function(e){null!==e&&(n(e),s([].concat(Object(b.a)(o),[e])))})).catch((function(e){console.log(e)})),m(!1)},type:"button",children:"Create family"})]})]})}function ce(){var e=Object(B.e)(),t=Object(B.f)().id,n=Object(c.useState)({ProductId:"",Barcode:"",ProductName:"",FamilyId:"",UnitMeasure:"piece",QuantityPerUnit:1,UnitPrice:null,Discontinued:!1,Stocks:[]}),a=Object(i.a)(n,2),r=a[0],o=a[1],s=Object(c.useState)({FamilyId:"",FamilyName:"unknown",Products:[]}),l=Object(i.a)(s,2),u=l[0],d=l[1],b=Object(c.useState)(!1),O=Object(i.a)(b,2),h=O[0],f=O[1];function m(e){var t=e.target,n=t.name,c=t.value;o(Object(M.a)(Object(M.a)({},r),{},Object(q.a)({},n,c)))}return Object(c.useEffect)((function(){t&&P.Products.details(t).then((function(e){null!==e&&o(e)})).catch((function(e){console.log(e)}))}),[t]),Object(c.useEffect)((function(){r.FamilyId!==u.FamilyId&&""!==u.FamilyId&&o(Object(M.a)(Object(M.a)({},r),{},{FamilyId:u.FamilyId}))}),[u]),Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(z.a,{centered:!0,columns:2,children:Object(I.jsxs)(z.a.Column,{children:[Object(I.jsxs)(j.a,{as:"h2",children:[t?"Edit":"New"," product"]}),Object(I.jsxs)(G.a,{onSubmit:function(){!function(t){f(!0),t.ProductId?P.Products.update(t).then((function(){e.push("/product")})):P.Products.create(t).then((function(){e.push("/product")}));o(t),f(!1)}(r)},children:[Object(I.jsx)(G.a.Input,{required:!0,placeholder:"Product Name",value:r.ProductName||"",name:"ProductName",onChange:m}),Object(I.jsx)(G.a.Input,{placeholder:"Barcode",value:r.Barcode||"",name:"Barcode",onChange:m}),Object(I.jsx)(G.a.Input,{placeholder:"Product Price",value:r.UnitPrice||"",name:"UnitPrice",onChange:m}),Object(I.jsx)(G.a.Input,{placeholder:"Unit Measure",value:r.UnitMeasure||"",name:"UnitMeasure",onChange:m}),Object(I.jsx)(G.a.Input,{placeholder:"Quantity per Unit",value:r.QuantityPerUnit||"",name:"QuantityPerUnit",onChange:m}),Object(I.jsx)(G.a.Checkbox,{label:"Discontinued",checked:r.Discontinued||!1,name:"Discontinued",onChange:function(){o(Object(M.a)(Object(M.a)({},r),{},{Discontinued:!r.Discontinued}))}}),Object(I.jsx)(ne,{setCurrentFamily:d,currentFamily:u}),Object(I.jsx)(T.a,{loading:h,positive:!0,type:"submit",children:"Submit"}),Object(I.jsx)(T.a,{onClick:function(){e.push("/product")},type:"button",children:"Cancel"})]})]})})})}function ae(){var e=a.a.useContext(y),t=e.userRoles,n=(e.setUserRoles,e.roles),r=(e.setRoles,Object(B.e)()),o=Object(B.f)().id,s=Object(c.useState)({Id:"",UserName:"",Email:"",PhoneNumber:"",Address:"",City:"",Token:"",Sales:[],Photos:[],Roles:[]}),l=Object(i.a)(s,2),u=l[0],d=l[1],O=Object(c.useState)(!1),h=Object(i.a)(O,2),f=h[0],m=h[1],x=Object(c.useState)(""),v=Object(i.a)(x,2),p=v[0],g=v[1];Object(c.useEffect)((function(){o&&P.Users.details(o).then((function(e){null!==e&&d(e)})).catch((function(e){console.log(e),g(e)}))}),[o]);var S={Id:"",Name:""},C=Object(c.useState)(S),U=Object(i.a)(C,2),N=U[0],D=U[1];function F(e){var t=e.target,n=t.name,c=t.value;d(Object(M.a)(Object(M.a)({},u),{},Object(q.a)({},n,c)))}function w(e){console.log(e);var n=e.target;if(""!==n.value&&!t.some((function(e){return e.Name===n.value}))){var c={Id:n.id,Name:n.value};D(c),d(Object(M.a)(Object(M.a)({},u),{},{Roles:[].concat(Object(b.a)(u.Roles),[c.Id])})),P.Roles.addrole(u.Id,c).then((function(e){null!==e&&d(e)})).catch((function(e){console.log(e),g(e)}))}}function k(e){console.log(e);var n=e.target;""!==n.value&&t.some((function(e){return e.Name===n.value}))&&(D(S),d(Object(M.a)(Object(M.a)({},u),{},{Roles:Object(b.a)(u.Roles.filter((function(e){return e!==n.id})))})))}return Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(z.a,{centered:!0,columns:2,children:Object(I.jsxs)(z.a.Column,{children:[Object(I.jsxs)(j.a,{as:"h2",children:['Edit user "',u.UserName,'"']}),Object(I.jsx)(ee.a.Group,{children:Object(I.jsxs)(G.a,{onSubmit:function(){!function(e){m(!0),e.Id?P.Users.update(e).then((function(){r.push("/")})):P.Users.create(e).then((function(){r.push("/")}));d(e),m(!1)}(u)},error:!!p,children:[Object(I.jsxs)(ee.a,{children:[Object(I.jsx)(G.a.Input,{required:!0,placeholder:"User Name",value:u.UserName||"",name:"UserName",onChange:F}),Object(I.jsx)(G.a.Input,{required:!0,placeholder:"Email",value:u.Email||"",name:"Email",onChange:F}),Object(I.jsx)(G.a.Input,{placeholder:"Phone Number",value:u.PhoneNumber||"",name:"PhoneNumber",onChange:F}),Object(I.jsx)(G.a.Input,{placeholder:"Address",value:u.Address||"",name:"Address",onChange:F}),Object(I.jsx)(G.a.Input,{placeholder:"City",value:u.City||"",name:"City",onChange:F})]}),Object(I.jsx)(ee.a,{children:Object(I.jsxs)(z.a,{children:[Object(I.jsxs)(z.a.Row,{children:[Object(I.jsx)(z.a.Column,{width:8,children:Object(I.jsxs)(j.a,{as:"h4",children:['Roles of "',u.UserName,'":']})}),Object(I.jsx)(z.a.Column,{width:8,children:t.map((function(e){return Object(I.jsx)(T.a,{size:"mini",type:"button",onClick:k,id:e.Id,value:e.Name,children:e.Name},e.Id)}))})]}),Object(I.jsxs)(z.a.Row,{children:[Object(I.jsx)(z.a.Column,{width:8,children:Object(I.jsx)(j.a,{as:"h4",children:"Available Roles:"})}),Object(I.jsx)(z.a.Column,{width:8,children:n.map((function(e){return Object(I.jsx)(T.a,{size:"mini",type:"button",onClick:w,id:e.Id,value:e.Name,children:e.Name},e.Id)}))})]}),Object(I.jsx)(z.a.Row,{children:Object(I.jsxs)(z.a.Column,{width:16,children:[Object(I.jsx)(te.a,{placeholder:"Add Role",name:"Role",value:N.Name||"",onChange:function(e){var t=e.target.value;D({Id:"",Name:t})}}),Object(I.jsx)(T.a,{loading:f,onClick:function(){""!==N.Id||n.some((function(e){return e.Name===N.Name}))||(m(!0),P.Roles.create({Name:N.Name}).then((function(e){null!==e&&D(e)})).catch((function(e){console.log(e),g(e)})),m(!1))},type:"button",children:"Create role"})]})})]})}),Object(I.jsxs)(ee.a,{children:[Object(I.jsx)(T.a,{loading:f,positive:!0,type:"submit",children:"Submit"}),Object(I.jsx)(T.a,{onClick:function(){r.push("/")},type:"button",children:"Cancel"})]}),Object(I.jsx)(W.a,{error:!0,content:p.toString()})]})})]})})})}function re(){var e=a.a.useContext(D),t=a.a.useContext(y),n=Object(c.useState)(!1),r=Object(i.a)(n,2),o=r[0],s=r[1],l=Object(c.useState)(0),u=Object(i.a)(l,2),d=u[0],O=u[1],h=Object(c.useState)(0),f=Object(i.a)(h,2),m=f[0],x=f[1];function v(t){var n=t.target,c=e.activeSalesDetails,a=c.find((function(e){return e.Product===n.value}));void 0!==a&&0!==a.UnitPrice&&(a.Quantity+=1,a.LineTotal+=a.UnitPrice,g(a),e.setActiveSalesDetails([].concat(Object(b.a)(c.filter((function(e){return e.SalesDetailId!==(null===a||void 0===a?void 0:a.SalesDetailId)}))),[a])),s(!1))}function p(t){var n=t.target,c=e.activeSalesDetails,a=c.find((function(e){return e.Product===n.value}));void 0!==a&&0!==a.UnitPrice&&a.Quantity>0&&(a.Quantity-=1,a.LineTotal-=a.UnitPrice,g(a),e.setActiveSalesDetails([].concat(Object(b.a)(c.filter((function(e){return e.SalesDetailId!==(null===a||void 0===a?void 0:a.SalesDetailId)}))),[a])),s(!1))}function g(e){return s(!0),P.SalesDetails.update(e)}return Object(c.useEffect)((function(){e.fillUserSales()}),[t.user]),Object(c.useEffect)((function(){e.fillUserSalesDetails(),e.fillActiveSalesDetails(),e.fillCartProducts()}),[e.activeSale,e.setActiveSale]),Object(c.useEffect)((function(){var t=0;e.activeSalesDetails.map((function(e){t+=e.LineTotal})),x(t),O(e.cartProducts.length)}),[e.activeSalesDetails,e.cartProducts]),Object(I.jsx)(I.Fragment,{children:d>0?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(j.a,{as:"h1",children:"Your Cart"}),Object(I.jsxs)(z.a,{children:[Object(I.jsx)(z.a.Column,{width:10,children:e.cartProducts.map((function(t){var n,c,a,r;return Object(I.jsx)(R.a,{fluid:!0,children:Object(I.jsxs)(R.a.Content,{children:[Object(I.jsx)(R.a.Header,{as:"h2",children:t.ProductName}),Object(I.jsxs)(R.a.Meta,{children:["    ",Object(I.jsxs)("p",{children:["Barcode: ",t.Barcode]})]}),Object(I.jsxs)(R.a.Description,{children:[Object(I.jsxs)(z.a,{children:[Object(I.jsx)(z.a.Column,{floated:"left",width:10,children:Object(I.jsxs)("p",{children:["Price: ",t.UnitPrice,"\u20ac per ",t.QuantityPerUnit," ",t.UnitMeasure]})}),Object(I.jsx)(z.a.Column,{floated:"right",width:6,children:Object(I.jsxs)("strong",{children:["Total: ",null===(n=e.activeSalesDetails)||void 0===n||null===(c=n.find((function(e){return e.Product===t.ProductId})))||void 0===c?void 0:c.LineTotal,"\u20ac "]})})]}),Object(I.jsx)($.a,{children:null===(a=e.families.find((function(e){return e.FamilyId===t.FamilyId})))||void 0===a?void 0:a.FamilyName}),Object(I.jsxs)(T.a.Group,{size:"large",floated:"right",children:[Object(I.jsx)(T.a,{loading:o,negative:!0,onClick:p,type:"button",value:t.ProductId,children:"-"}),Object(I.jsxs)(T.a,{children:[null===(r=e.activeSalesDetails.find((function(e){return e.Product===t.ProductId})))||void 0===r?void 0:r.Quantity," ",t.UnitMeasure]}),Object(I.jsx)(T.a,{loading:o,positive:!0,onClick:v,type:"button",value:t.ProductId,children:"+"})]})]})]})},t.ProductId)}))}),Object(I.jsx)(z.a.Column,{width:6,children:Object(I.jsxs)(ee.a,{children:[Object(I.jsx)(j.a,{as:"h2",children:"Total:"}),Object(I.jsxs)("p",{children:[d," units for ",m,"\u20ac"]})]})})]})]}):Object(I.jsx)(j.a,{as:"h1",children:"Your Cart is empty"})})}var oe=function(){var e=a.a.useContext(y),t=a.a.useContext(D),n=Object(B.e)(),r=Object(c.useState)(!0),o=Object(i.a)(r,2),l=o[0],u=o[1];return Object(c.useEffect)((function(){e.userToken?(console.log("the token: "+e.userToken),e.getCurrentUser(),e.user&&(t.fillUserSales(),t.fillCartProducts(),t.fillUserSalesDetails(),t.fillActiveSalesDetails()),u(!1)):u(!1)}),[]),l?Object(I.jsx)(E,{content:"Loading App ..."}):Object(I.jsxs)("div",{className:"App",children:[Object(I.jsx)(w,{logout:function(){e.setUser(null),window.localStorage.removeItem("jwt"),console.log("Successfully loged out"),n.push("/")}}),Object(I.jsxs)(s.a,{style:{marginTop:"7em"},children:[Object(I.jsx)(B.a,{exact:!0,path:"/",component:X}),Object(I.jsx)(B.a,{path:"/store",component:Q}),Object(I.jsx)(B.a,{path:["/newstore","/editstore/:id"],component:H}),Object(I.jsx)(B.a,{path:"/product",component:_}),Object(I.jsx)(B.a,{path:["/newproduct","/editproduct/:id"],component:ce}),Object(I.jsx)(B.a,{path:["/newuser","/edituser/:id"],component:ae}),Object(I.jsx)(B.a,{path:"/cartlist/:id",component:re}),Object(I.jsx)(B.a,{path:"/login",component:K}),Object(I.jsx)(B.a,{path:"/register",component:Z})]})]})},ie=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,217)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),c(e),a(e),r(e),o(e)}))};o.a.render(Object(I.jsx)(U,{children:Object(I.jsx)(F,{children:Object(I.jsx)(l.a,{children:Object(I.jsx)(oe,{})})})}),document.getElementById("root")),ie()}},[[191,1,2]]]);
//# sourceMappingURL=main.43723416.chunk.js.map